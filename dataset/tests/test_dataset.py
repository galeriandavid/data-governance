"""Test shape and values imgs and masks generated by dataset
 """

import torch
from dataset import SegmentationDataset


dataset = SegmentationDataset("dataset/tests/test_data/")


def test_mask_shape():
    """Test that mask num channels equal number of classes
    """
    img, mask = dataset[0]
    assert mask.shape[0] == dataset.num_classes


def test_image_shape():
    """Test img shape
    """
    img, mask = dataset[0]
    assert tuple(img.shape) == (3, 128, 128)


def test_image_and_mask_shape():
    """Test that shape of mask and image is same
    """
    img, mask = dataset[0]
    assert img.shape[1:] == mask.shape[1:]


def test_image_values():
    """Test that img values between 0 and 1
    """
    img, mask = dataset[0]
    assert ((img >= 0).all() and (img <= 1).all()).item()

def test_mask_values():
    """Test that mask values is 0 or 1 only
    """
    img, mask = dataset[0]
    assert ((mask == 0) + (mask == 1)).all().item()
